Query #1:
---------
	
SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | stats count() as `Event Count`	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #2:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() by span(@timestamp, 30d)	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"date_histogram": {
"field": "@timestamp",
"fixed_interval": "30d",
"time_zone": "America/Los_Angeles",
"min_doc_count": 1
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #3:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | stats count() as Count by `aws.cloudtrail.userIdentity.accountId` | eval `Account Id` = CAST(`aws.cloudtrail.userIdentity.accountId` AS STRING) | sort - Count | head 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.userIdentity.accountId.keyword",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #4:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() as Count by `aws.cloudtrail.eventCategory` | SORT - Count | HEAD 5	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventCategory",
"order": {
"_count": "desc"
},
"size": 5
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #5:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() as Count by `aws.cloudtrail.awsRegion` | SORT - Count | HEAD 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.awsRegion",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #6:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() as Count by `aws.cloudtrail.eventName` | SORT - Count | HEAD 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventName",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #7:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() as Count by `aws.cloudtrail.eventSource` | SORT - Count | HEAD 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventSource",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #8:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | WHERE NOT (aws.cloudtrail.sourceIPAddress LIKE '%.amazon%.com%' OR aws.cloudtrail.sourceIPAddress LIKE 'AWS%') | STATS count() as Count by aws.cloudtrail.sourceIPAddress | SORT - Count | HEAD 10

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.sourceIPAddress",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"must_not": {
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.sourceIPAddress"
],
"query": "*\\.amazon*\\.com* AWS*"
}
}
],
"minimum_should_match": 1
}
}
}
}
],
"should": [],
"must_not": []
}
}
}

Query #9:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | STATS count() as Count by aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.userName, aws.cloudtrail.userIdentity.accountId, aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.type | rename aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.userName as `User Name`, aws.cloudtrail.userIdentity.accountId as `Account Id`, aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.type as `Type` | SORT - Count | HEAD 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.userName.keyword",
"order": {
"_count": "desc"
},
"size": 10
},
"aggs": {
"4": {
"terms": {
"field": "aws.cloudtrail.userIdentity.accountId.keyword",
"order": {
"_count": "desc"
},
"size": 10
},
"aggs": {
"5": {
"terms": {
"field": "aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.type.keyword",
"order": {
"_count": "desc"
},
"size": 10
}
}
}
}
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
}
}

Query #10:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | parse `aws.cloudtrail.eventSource` "(?<service>s3.*)" | WHERE isnotnull(service) and `errorCode`="AccessDenied" | STATS count() as Count	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"filter": [
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "s\\3*"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"should": [
{
"match": {
"errorCode": "AccessDenied"
}
}
],
"minimum_should_match": 1
}
}
]
}
},
{
"bool": {
"should": [
{
"exists": {
"field": "errorCode"
}
}
],
"minimum_should_match": 1
}
}
],
"should": [],
"must_not": []
}
}
}

Query #11:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | where `aws.cloudtrail.eventSource` like "s3%" | stats count() as Count by `aws.cloudtrail.requestParameters.bucketName` | sort - Count | head 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.requestParameters.bucketName.keyword",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "s\\3*"
}
}
],
"minimum_should_match": 1
}
}
],
"should": [],
"must_not": []
}
}
}

Query #12:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | WHERE `aws.cloudtrail.eventSource` like 's3%' and not (`aws.cloudtrail.eventName` like 'Get%' or `aws.cloudtrail.eventName` like 'Describe%' or `aws.cloudtrail.eventName` like 'List%' or `aws.cloudtrail.eventName` like 'Head%') | STATS count() as Count by `aws.cloudtrail.eventName`, `aws.cloudtrail.requestParameters.bucketName` | RENAME `aws.cloudtrail.eventName` as `Event`, `aws.cloudtrail.requestParameters.bucketName` as `Bucket Name` | SORT - Count | HEAD 100

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventName",
"order": {
"_count": "desc"
},
"size": 10
},
"aggs": {
"3": {
"terms": {
"field": "aws.cloudtrail.requestParameters.bucketName.keyword",
"order": {
"_count": "desc"
},
"size": 10
}
}
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "s\\3*"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"must_not": {
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventName"
],
"query": "Get*  Describe*  List* Head*"
}
}
],
"minimum_should_match": 1
}
}
}
}
],
"should": [],
"must_not": []
}
}
}

Query #13:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | where `aws.cloudtrail.eventSource` like "ec2%" and (`aws.cloudtrail.eventName` = "RunInstances" or `aws.cloudtrail.eventName` = "TerminateInstances" or `aws.cloudtrail.eventName` = "StopInstances") and not (`aws.cloudtrail.eventName` like "Get%" or `aws.cloudtrail.eventName` like "Describe%" or `aws.cloudtrail.eventName` like "List%" or `aws.cloudtrail.eventName` like "Head%") | stats count() as Count by `aws.cloudtrail.eventName` | sort - Count | head 5

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventName",
"order": {
"_count": "desc"
},
"size": 5
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"filter": [
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "ec\\2*"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"should": [
{
"bool": {
"should": [
{
"match": {
"aws.cloudtrail.eventName": "RunInstances"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"should": [
{
"bool": {
"should": [
{
"match": {
"aws.cloudtrail.eventName": "TerminateInstances"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"should": [
{
"bool": {
"should": [
{
"match": {
"aws.cloudtrail.eventName": "RunInstances"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"should": [
{
"match": {
"aws.cloudtrail.eventName": "StopInstances"
}
}
],
"minimum_should_match": 1
}
}
],
"minimum_should_match": 1
}
}
],
"minimum_should_match": 1
}
}
],
"minimum_should_match": 1
}
}
]
}
},
{
"bool": {
"must_not": {
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventName"
],
"query": "Get*  Describe*  List* Head*"
}
}
],
"minimum_should_match": 1
}
}
}
}
],
"should": [],
"must_not": []
}
}
}

Query #14:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | WHERE `aws.cloudtrail.eventSource` = 'ec2*' and not (`aws.cloudtrail.eventName` = 'Get*' or `aws.cloudtrail.eventName` = 'Describe*' or `aws.cloudtrail.eventName` = 'List*' or `aws.cloudtrail.eventName` = 'Head*') | STATS count() as Count by `aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.userName` | SORT - Count | HEAD 10

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.userIdentity.sessionContext.sessionIssuer.userName.keyword",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "ec\\2*"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"must_not": {
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventName"
],
"query": "Get*  Describe*  List* Head*"
}
}
],
"minimum_should_match": 1
}
}
}
}
],
"should": [],
"must_not": []
}
}
}

Query #15:
---------

SOURCE = flint_new_data_source_default_aws_cloudtrail__001 | where `aws.cloudtrail.eventSource` like "ec2%" and not (`aws.cloudtrail.eventName` like "Get%" or `aws.cloudtrail.eventName` like "Describe%" or `aws.cloudtrail.eventName` like "List%" or `aws.cloudtrail.eventName` like "Head%") | stats count() as Count by `aws.cloudtrail.eventName` | rename `aws.cloudtrail.eventName` as `Event Name` | sort - Count | head 10	

POST flint_new_data_source_default_aws_cloudtrail__001/_search
{
"track_total_hits": true,
"aggs": {
"2": {
"terms": {
"field": "aws.cloudtrail.eventName",
"order": {
"_count": "desc"
},
"size": 10
}
}
},
"size": 0,
"stored_fields": [
"*"
],
"script_fields": {},
"docvalue_fields": [
{
"field": "@timestamp",
"format": "date_time"
},
{
"field": "aws.cloudtrail.eventTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.endTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.requestParameter.startTime",
"format": "date_time"
},
{
"field": "aws.cloudtrail.responseElements.lastModified",
"format": "date_time"
},
{
"field": "aws.cloudtrail.userIdentity.sessionContext.attributes.creationDate",
"format": "date_time"
}
],
"_source": {
"excludes": []
},
"query": {
"bool": {
"must": [],
"filter": [
{
"match_all": {}
},
{
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventSource"
],
"query": "ec\\2*"
}
}
],
"minimum_should_match": 1
}
},
{
"bool": {
"must_not": {
"bool": {
"should": [
{
"query_string": {
"fields": [
"aws.cloudtrail.eventName"
],
"query": "Get*  Describe*  List* Head*"
}
}
],
"minimum_should_match": 1
}
}
}
}
],
"should": [],
"must_not": []
}
}
}

Query #16:
---------
	
SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.pkts`) as packet_count by span(`aws.networkfirewall.event.timestamp`, 1d) as timestamp_span, `aws.networkfirewall.event.src_ip` | rename `aws.networkfirewall.event.src_ip` as `Source IP` | sort - packet_count | head 10	

POST flint_new_data_source_default_amazon_networkfirewall__mview/_search
{
"track_total_hits": true,
"size": 0,
"aggs": {
"source_ips": {
"terms": {
"field": "aws.networkfirewall.event.src_ip",
"size": 10,
"order": {
"total_packets": "desc"
}
},
"aggs": {
"total_packets": {
"sum": {
"field": "aws.networkfirewall.event.netflow.pkts"
}
},
"time_series": {
"date_histogram": {
"field": "aws.networkfirewall.event.timestamp",
"fixed_interval": "24h"
},
"aggs": {
"packet_count": {
"sum": {
"field": "aws.networkfirewall.event.netflow.pkts"
}
}
}
}
}
}
},
"query": {
"bool": {
"filter": [
{
"match_all": {}
}
],
"should": [],
"must_not": []
}
}
}